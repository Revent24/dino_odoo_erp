<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <!-- ==============================================
             FORM VIEW: –§–æ—Ä–º–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏
             –°–æ–¥–µ—Ä–∂–∏—Ç: –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è, —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é, –∏—Ç–æ–≥–∏
             ============================================== -->
        <record id="view_dino_operation_document_form_v3" model="ir.ui.view">
            <field name="name">dino.operation.document.form</field>
            <field name="model">dino.operation.document</field>
            <field name="priority">16</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="Document" display="horizontal">
                    <header>
                        <field name="state" widget="statusbar" options="{'clickable': '1'}"/>
                    </header>
                    <sheet>
                        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫: –¢–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç–∞ -->
                        <div class="oe_title">
                            <h1 style="width: 120%;">
                                <field name="document_type_id" options="{'no_create_edit': False}" nolabel="1"/>
                            </h1>
                        </div>
                        <!-- –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è: –Ω–æ–º–µ—Ä, –¥–∞—Ç–∞, –ø–∞—Ä—Ç–Ω–µ—Ä, –≤–∞–ª—é—Ç–∞ -->
                        <group>
                            <group>
                                <field name="number"/>
                                <field name="date"/>
                            </group>
                            <group>
                                <field name="project_id"/>
                                <field name="partner_id"/>
                                <field name="currency_id"/>
                                <field name="vat_rate"/>
                            </group>
                        </group>

                        <!-- –í–∫–ª–∞–¥–∫–∏: –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –ü—Ä–∏–º–µ—á–∞–Ω–∏—è -->
                        <notebook>
                            <page string="Nomenclature" name="specification">
                                <!-- –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è: —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º—ã–π —Å–ø–∏—Å–æ–∫ —Å handle –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ -->
                                <field name="specification_ids" context="{'default_document_id': id}">
                                    <list string="Nomenclature" editable="bottom">
                                        <field name="sequence" widget="handle"/>
                                        <field name="line_number" string="‚Ññ"/>
                                        <field name="supplier_nomenclature_id" string="Supplier Item" context="{'default_partner_id': parent.partner_id}" options="{'no_open': True}"/>
                                        <field name="nomenclature_id" 
                                               string="Stock Item"
                                               optional="hide"
                                               widget="many2one"
                                               options="{'no_quick_create': True}"
                                               context="{
                                                   'default_name': name, 
                                                   'supplier_item_name': name,
                                                   'form_view_ref': 'dino_erp.view_nomenclature_quick_create_form'
                                               }"/>
                                        <field name="quantity" string="Qty"/>
                                        <field name="dino_uom_id" string="Unit"/>
                                        <field name="article" string="Article" optional="hide"/>
                                        <field name="ukt_zed" string="UKT ZED" optional="hide"/>
                                        <field name="price_untaxed" string="Price"/>
                                        <field name="price_tax" string="Price w/Tax" optional="hide"/>
                                        <field name="amount_untaxed" string="Subtotal" optional="hide"/>
                                        <field name="amount_tax" string="Tax" optional="hide"/>
                                        <field name="vat_rate" string="VAT %" optional="hide" readonly="1"/>
                                        <field name="amount_total" string="Total"/>
                                        <field name="description" string="Notes" optional="hide"/>
                                    </list>
                                </field>
                                
                                <!-- –ò—Ç–æ–≥–∏: –°—É–º–º–∞ –±–µ–∑ –ù–î–°, –ù–î–°, –û–±—â–∞—è —Å—É–º–º–∞ (–ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω–∞ –≤–∫–ª–∞–¥–∫–µ Nomenclature) -->
                                <div class="oe_subtotal_wrapper">
                                    <group>
                                        <group/>

                                        <group class="oe_subtotal_footer oe_right">
                                            <field name="amount_untaxed"
                                                   widget="monetary"
                                                   options="{'currency_field': 'currency_id'}"/>

                                            <field name="amount_tax"
                                                   widget="monetary"
                                                   options="{'currency_field': 'currency_id'}"/>

                                            <field name="amount_total"
                                                   class="oe_subtotal_footer_separator"
                                                   widget="monetary"
                                                   options="{'currency_field': 'currency_id'}"/>
                                        </group>
                                    </group>
                                    <div class="oe_clear"/>
                                </div>
                            </page>

                            <!-- –ò–º–ø–æ—Ä—Ç –∏–∑ —Ç–µ–∫—Å—Ç–∞ -->
                            <page string="Import Text" name="import_text">
                                <group>
                                    <group>
                                        <field name="parser_agent_id" 
                                               options="{'no_create': True}"
                                               placeholder="–í—ã–±–µ—Ä–∏—Ç–µ –∞–≥–µ–Ω—Ç–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞..."/>
                                    </group>
                                    <group>
                                        <button name="action_import_text" 
                                            string="–ò–º–ø–æ—Ä—Ç" 
                                            type="object" 
                                            class="btn-primary"
                                            icon="fa-magic"/>
                                    </group>
                                </group>
                                
                                <separator string="–¢–µ–∫—Å—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞ –∏–ª–∏ —Å–∫—Ä–∏–Ω—à–æ—Ç"/>
                                <field name="import_text_content" 
                                       placeholder="–í—Å—Ç–∞–≤—å—Ç–µ —Ç–µ–∫—Å—Ç –∏–ª–∏ —Å–∫—Ä–∏–Ω—à–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞ (Ctrl+V)..."
                                       nolabel="1"
                                       options="{'style-inline': true}"/>
                                
                                <separator string="–ò–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª"/>
                                <group>
                                    <field name="import_image" 
                                           filename="import_image_filename"
                                           nolabel="1"/>
                                    <field name="import_image_filename" invisible="1"/>
                                </group>
                                
                                <!-- JSON debug removed: ocr_result_text field deleted -->
                                
                                <group>
                                    <div class="alert alert-info" role="alert">
                                        <strong>üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏–º–ø–æ—Ä—Ç—É:</strong>
                                        <ol style="margin: 5px 0 0 0; padding-left: 20px;">
                                            <li><b>–í—Å—Ç–∞–≤—å—Ç–µ —Ç–µ–∫—Å—Ç –∏–ª–∏ —Å–∫—Ä–∏–Ω—à–æ—Ç</b> –ø—Ä—è–º–æ –≤ –ø–æ–ª–µ –≤—ã—à–µ (Ctrl+V)</li>
                                            <li><b>–ò–õ–ò –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª</b> —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –¥–æ–∫—É–º–µ–Ω—Ç–∞</li>
                                            <li><b>–í—ã–±–µ—Ä–∏—Ç–µ –∞–≥–µ–Ω—Ç–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞:</b>
                                                <ul style="margin: 3px 0 0 0;">
                                                    <li>Regex Parser - –¥–ª—è —Ç–µ–∫—Å—Ç–∞ (–±—ã—Å—Ç—Ä–æ, –±–µ—Å–ø–ª–∞—Ç–Ω–æ)</li>
                                                    <li>AI Parser - –¥–ª—è —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤ –∏ —Ñ–æ—Ç–æ (—Ç–æ—á–Ω–µ–µ, –ø–ª–∞—Ç–Ω–æ)</li>
                                                </ul>
                                            </li>
                                            <li>–ù–∞–∂–º–∏—Ç–µ <b>"–ò–º–ø–æ—Ä—Ç"</b> - —Å–∏—Å—Ç–µ–º–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é</li>
                                        </ol>
                                        <p style="margin: 10px 0 0 0;"><i>üí° AI-–ø–∞—Ä—Å–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç —Å —Ñ–æ—Ç–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, —Å–∫–∞–Ω–∞–º–∏, —Å—á–µ—Ç–∞–º–∏ –ª—é–±–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞</i></p>
                                    </div>
                                </group>
                            </page>

                            <!-- –í–ª–æ–∂–µ–Ω–∏—è –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ -->
                            <page string="Import Files" name="attachments">
                                <group>
                                    <div class="alert alert-info" role="alert">
                                        <strong>üìé –ö–∞–∫ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—É:</strong>
                                        <ol style="margin: 5px 0 0 0; padding-left: 20px;">
                                            <li>–ù–∞–∂–º–∏—Ç–µ "–î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É"</li>
                                            <li>–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª (Excel)</li>
                                            <li>–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –ø–∞—Ä—Å–µ—Ä–∞ (Sapriz –¥–ª—è —Å—á–µ—Ç–æ–≤ 1–°)</li>
                                            <li>–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "Import" —Å–ø—Ä–∞–≤–∞</li>
                                            <li>–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–π–¥–µ—Ç –∏–ª–∏ —Å–æ–∑–¥–∞—Å—Ç –ø–æ–∑–∏—Ü–∏–∏ –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–µ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞</li>
                                        </ol>
                                    </div>
                                </group>
                                <field name="attachment_ids" 
                                       context="{'default_document_id': id}">
                                    <list editable="bottom"
                                          decoration-success="import_status=='imported'" 
                                          decoration-danger="import_status=='error'"
                                          decoration-muted="import_status=='draft'">
                                        <field name="filename"/>
                                        <field name="file_data" filename="filename"/>
                                        <field name="parser_type"/>
                                        <field name="import_status" widget="badge" readonly="1"
                                               decoration-success="import_status=='imported'"
                                               decoration-warning="import_status=='importing'"
                                               decoration-danger="import_status=='error'"
                                               decoration-info="import_status=='draft'"/>
                                        <field name="imported_lines_count" readonly="1" optional="hide"/>
                                        <field name="import_date" readonly="1" optional="hide"/>
                                        <button name="action_import" 
                                                string="Import" 
                                                type="object" 
                                                icon="fa-download"
                                                class="btn-primary"
                                                invisible="import_status in ['imported', 'importing']"/>
                                        <button name="action_reset" 
                                                string="Reset" 
                                                type="object" 
                                                icon="fa-refresh"
                                                invisible="import_status == 'draft'"/>
                                    </list>
                                </field>
                            </page>

                            <!-- –ü—Ä–∏–º–µ—á–∞–Ω–∏—è: HTML-–ø–æ–ª–µ –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ -->
                            <page string="Notes" name="notes">
                                <field name="notes"/>
                            </page>
                            
                        </notebook>
                    </sheet>
                    <chatter/>
                </form>
            </field>
        </record>

        <!-- ==============================================
             TREE VIEW: –°–ø–∏—Å–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
             ============================================== -->
        <record id="view_dino_operation_document_tree" model="ir.ui.view">
            <field name="name">dino.operation.document.tree</field>
            <field name="model">dino.operation.document</field>
            <field name="arch" type="xml">
                <list string="Documents">
                    <field name="state" widget="badge" decoration-info="state == 'draft'" decoration-warning="state == 'edit'" decoration-success="state == 'ready'" decoration-muted="state == 'done'"/>
                    <field name="document_type_id"/>
                    <field name="number"/>
                    <field name="date"/>
                    <field name="partner_id"/>
                    <field name="project_id"/>
                    <field name="amount_total"/>
                </list>
            </field>
        </record>

        <!-- Action moved to core/main_menu.xml -->

        <!-- ==============================================
             TREE VIEW: –ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤ (–¥–ª—è —Å–º–∞—Ä—Ç-–∫–Ω–æ–ø–∫–∏ –∏–∑ –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã)
             –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç: –î–∞—Ç–∞, –î–æ–∫—É–º–µ–Ω—Ç, –ü–æ—Å—Ç–∞–≤—â–∏–∫, –ù–∞–∑–≤–∞–Ω–∏–µ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞, –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ, –¶–µ–Ω—ã
             ============================================== -->
        <record id="view_specification_price_history_tree" model="ir.ui.view">
            <field name="name">dino.operation.document.specification.price.history</field>
            <field name="model">dino.operation.document.specification</field>
            <field name="priority">20</field>
            <field name="arch" type="xml">
                <list string="Price History" create="false" edit="false">
                    <field name="document_date" string="Date"/>
                    <field name="document_id" string="Document" optional="hide"/>
                    <field name="document_number" string="Doc #"/>
                    <field name="partner_id" string="Partner"/>
                    <field name="name" string="Supplier Item Name"/>
                    <field name="quantity" string="Quantity"/>
                    <field name="dino_uom_id" string="Unit"/>
                    <field name="price_untaxed" string="Price w/o VAT" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    <field name="price_tax" string="Price with VAT" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                    <field name="currency_id" column_invisible="True"/>
                </list>
            </field>
        </record>
    </data>
</odoo>

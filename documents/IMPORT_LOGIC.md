# –õ–æ–≥–∏–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã (–≥–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥)

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

### 1. –ì–∏–±—Ä–∏–¥–Ω—ã–π –≤–≤–æ–¥ –¥–æ–∫—É–º–µ–Ω—Ç–∞
**–ú–æ–¥–µ–ª—å:** `dino.operation.document`

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤–≤–µ—Å—Ç–∏ –¥–æ–∫—É–º–µ–Ω—Ç:
- **–¢–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ HTML** - –≤—Å—Ç–∞–≤–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- **–°–∫—Ä–∏–Ω—à–æ—Ç/–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ** - –≤—Å—Ç–∞–≤–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞
- –ö–æ–º–±–∏–Ω–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

**–ü–æ–ª—è:**
- `import_text_content` - HTML –ø–æ–ª–µ –¥–ª—è —Ç–µ–∫—Å—Ç–∞/–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- `parser_agent_id` - –≤—ã–±–æ—Ä –º–æ–¥–µ–ª–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞

### 2. –ú–æ–¥–µ–ª–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞
**–ú–æ–¥–µ–ª—å:** `dino.parser.agent`

–ù–∞–±–æ—Ä –∞–≥–µ–Ω—Ç–æ–≤ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤:
- **Python Regex Parser** - –ª–æ–∫–∞–ª—å–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ –ø–æ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–º –≤—ã—Ä–∞–∂–µ–Ω–∏—è–º
- **OpenAI-Compatible API (Universal)** - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø–∞—Ä—Å–µ—Ä –¥–ª—è OpenAI, Azure OpenAI, OpenRouter, Qwen –∏ –¥—Ä—É–≥–∏—Ö
- **Anthropic Claude** - –ø–∞—Ä—Å–∏–Ω–≥ —á–µ—Ä–µ–∑ Anthropic API (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)
- **Google Gemini** - –ø–∞—Ä—Å–∏–Ω–≥ —á–µ—Ä–µ–∑ Google AI API (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∞–≥–µ–Ω—Ç–∞:**

### –ü–æ–ª–Ω—ã–π –ø–µ—Ä–µ—á–µ–Ω—å –ø–æ–ª–µ–π –º–æ–¥–µ–ª–∏ `dino.parser.agent`

#### 1. –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–¥–ª—è –≤—Å–µ—Ö –∞–≥–µ–Ω—Ç–æ–≤):
```python
name = fields.Char('Agent Name', required=True)
    # –ù–∞–∑–≤–∞–Ω–∏–µ –∞–≥–µ–Ω—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: "GPT-4o Invoice Parser")
    
agent_type = fields.Selection([
    ('none', 'No Agent (Manual)'),
    ('regex_universal', 'Universal Regex Parser'),
    ('ai_openai_compatible', 'OpenAI-Compatible API (Universal)'),
    ('ai_anthropic', 'Anthropic Claude'),
    ('ai_google', 'Google Gemini'),
], string='Agent Type', required=True)
    # –¢–∏–ø –∞–≥–µ–Ω—Ç–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞
    # ai_openai_compatible —Ä–∞–±–æ—Ç–∞–µ—Ç —Å: OpenAI, Azure OpenAI, OpenRouter, Qwen –∏ –¥—Ä.
    
active = fields.Boolean('Active', default=True)
    # –ê–∫—Ç–∏–≤–µ–Ω –ª–∏ –∞–≥–µ–Ω—Ç
    
sequence = fields.Integer('Sequence', default=10)
    # –ü–æ—Ä—è–¥–æ–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –≤ —Å–ø–∏—Å–∫–µ
    
description = fields.Text('Description')
    # –û–ø–∏—Å–∞–Ω–∏–µ –∞–≥–µ–Ω—Ç–∞ –∏ –µ–≥–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π
```

#### 2. API Configuration (–¥–ª—è AI –∞–≥–µ–Ω—Ç–æ–≤):
```python
api_key = fields.Char('API Key', password=True)
    # –¢–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ API
    # –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –≤—Å–µ—Ö AI –∞–≥–µ–Ω—Ç–æ–≤
    
api_endpoint = fields.Char('API Endpoint')
    # URL endpoint API (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    # Defaults:
    #   OpenAI: https://api.openai.com/v1/chat/completions
    #   Anthropic: https://api.anthropic.com/v1/messages
    #   Google: https://generativelanguage.googleapis.com/v1beta/models/
    #   OpenRouter: https://openrouter.ai/api/v1/chat/completions
    #   Azure: https://<your-resource>.openai.azure.com/openai/deployments/<model>/chat/completions
    
model_name = fields.Char('Model Name', required=True)
    # ID –º–æ–¥–µ–ª–∏ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
    # –ü—Ä–∏–º–µ—Ä—ã:
    #   OpenAI: "gpt-4o", "gpt-4o-mini"
    #   Anthropic: "claude-3-5-sonnet-20240620", "claude-3-5-haiku-20241022"
    #   Google: "gemini-1.5-pro", "gemini-1.5-flash"
    #   OpenRouter: "qwen/qwen-2.5-vl-72b", "anthropic/claude-3.5-sonnet"
```

#### 3. Generation Parameters (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–æ–º):
```python
temperature = fields.Float('Temperature', default=0.0)
    # –£—Ä–æ–≤–µ–Ω—å "–∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏" AI (0.0-1.0)
    # 0.0 - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤)
    # 0.1 - –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å
    # 0.5-1.0 - –∫—Ä–µ–∞—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏ (–ù–ï –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞)
    
max_tokens = fields.Integer('Max Tokens', default=4096)
    # –ú–∞–∫—Å–∏–º—É–º —Ç–æ–∫–µ–Ω–æ–≤ –≤ –æ—Ç–≤–µ—Ç–µ
    # –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:
    #   –ü—Ä–æ—Å—Ç–∞—è –Ω–∞–∫–ª–∞–¥–Ω–∞—è (–¥–æ 20 –ø–æ–∑–∏—Ü–∏–π): 2048
    #   –°—Ä–µ–¥–Ω—è—è –Ω–∞–∫–ª–∞–¥–Ω–∞—è (–¥–æ 50 –ø–æ–∑–∏—Ü–∏–π): 4096
    #   –ë–æ–ª—å—à–∞—è –Ω–∞–∫–ª–∞–¥–Ω–∞—è (100+ –ø–æ–∑–∏—Ü–∏–π): 8192
    
top_p = fields.Float('Top P', default=1.0)
    # Nucleus sampling (0.0-1.0)
    # –î–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –æ—Å—Ç–∞–≤–ª—è—Ç—å 1.0
    
response_format = fields.Selection([
    ('json_object', 'Strict JSON'),
    ('text', 'Free Text'),
], default='json_object')
    # –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ –æ—Ç AI
    # json_object - —Å—Ç—Ä–æ–≥–∏–π JSON (–ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–æ)
```

#### 4. JSON Schema (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞):
**–§–∞–π–ª:** `documents/services/json_schema_template.json`

```python
# JSON —Å—Ö–µ–º–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ —Ñ–∞–π–ª–∞ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ
# –ù–µ –Ω—É–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –≤ –∫–∞–∂–¥–æ–π –∑–∞–ø–∏—Å–∏ –∞–≥–µ–Ω—Ç–∞
# –ï–¥–∏–Ω—ã–π —à–∞–±–ª–æ–Ω –¥–ª—è –≤—Å–µ—Ö –∞–≥–µ–Ω—Ç–æ–≤
# –õ–µ–≥–∫–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –û–¥–∏–Ω —à–∞–±–ª–æ–Ω –¥–ª—è –≤—Å–µ—Ö –∞–≥–µ–Ω—Ç–æ–≤
- –ù–µ –¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- –õ–µ–≥–∫–æ –æ–±–Ω–æ–≤–ª—è—Ç—å (–æ–¥–∏–Ω —Ñ–∞–π–ª –≤–º–µ—Å—Ç–æ N –∑–∞–ø–∏—Å–µ–π)
- –ú–µ–Ω—å—à–µ –º–µ—Å—Ç–∞ –≤ –ë–î

#### 5. Rate Limiting (–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø–æ–ª—è):
```python
rate_limit_rpm = fields.Integer('Rate Limit (RPM)', readonly=True)
    # –õ–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É (–∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏)
    # –ó–∞–≤–∏—Å–∏—Ç –æ—Ç Tier –∞–∫–∫–∞—É–Ω—Ç–∞ API
    
rate_limit_tpm = fields.Integer('Rate Limit (TPM)', readonly=True)
    # –õ–∏–º–∏—Ç —Ç–æ–∫–µ–Ω–æ–≤ –≤ –º–∏–Ω—É—Ç—É
    
rate_limit_rpd = fields.Integer('Rate Limit (RPD)', readonly=True)
    # –õ–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –¥–µ–Ω—å
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –≠—Ç–∏ –ø–æ–ª—è –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –∑–Ω–∞—á–µ–Ω–∏—è –≤—Ä—É—á–Ω—É—é –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–∞—Ä–∏—Ñ–Ω–æ–≥–æ –ø–ª–∞–Ω–∞ API.

#### 6. Usage Statistics (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞):
```python
usage_count = fields.Integer('Usage Count', readonly=True, default=0)
    # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–∑–æ–≤–æ–≤ –∞–≥–µ–Ω—Ç–∞
    # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –ø–∞—Ä—Å–∏–Ω–≥–µ
    
last_used_date = fields.Datetime('Last Used', readonly=True)
    # –î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
    
total_tokens_used = fields.Integer('Total Tokens Used', readonly=True, default=0)
    # –í—Å–µ–≥–æ —Ç–æ–∫–µ–Ω–æ–≤ –∏–∑—Ä–∞—Å—Ö–æ–¥–æ–≤–∞–Ω–æ (input + output)
    # –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ –æ—Ç–≤–µ—Ç–∞ API
    
total_cost = fields.Float('Total Cost ($)', readonly=True, default=0.0)
    # –û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ USD
    # –í—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–∞—Ä–∏—Ñ–æ–≤ –º–æ–¥–µ–ª–∏
```

### 3. –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π JSON –æ—Ç–≤–µ—Ç

**–í—Å–µ –º–æ–¥–µ–ª–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –µ–¥–∏–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É:**
```json
{
  "header": {
    "doc_type": "string: –í–∏–¥–∞—Ç–∫–æ–≤–∞ –Ω–∞–∫–ª–∞–¥–Ω–∞ / –†–∞—Ö—É–Ω–æ–∫ / –ê–∫—Ç",
    "doc_number": "string: –ù–æ–º–µ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞",
    "doc_date": "YYYY-MM-DD: –î–∞—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞",
    "vendor_name": "string: –ü–æ–≤–Ω–∞ –Ω–∞–∑–≤–∞ –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫–∞",
    "vendor_edrpou": "string: –ö–æ–¥ –Ñ–î–†–ü–û–£ (8 –∞–±–æ 10 —Ü–∏—Ñ—Ä)",
    "vendor_iban": "string: –ù–æ–º–µ—Ä —Ä–∞—Ö—É–Ω–∫—É —É —Ñ–æ—Ä–º–∞—Ç—ñ UA...",
    "vendor_bank": "string: –ù–∞–∑–≤–∞ –±–∞–Ω–∫—É –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫–∞",
    "vendor_bank_city": "string: –ú—ñ—Å—Ç–æ –±–∞–Ω–∫—É –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫–∞ –∞–±–æ null",
    "vendor_mfo": "string: –ú–§–û –±–∞–Ω–∫—É (6 —Ü–∏—Ñ—Ä). –Ø–∫—â–æ –Ω–µ –≤–∫–∞–∑–∞–Ω–æ —è–≤–Ω–æ ‚Äî –≤–∏—Ç—è–≥–Ω–∏ –∑ 5-10 —Å–∏–º–≤–æ–ª—ñ–≤ IBAN –∞–±–æ –∑–∞–ª–∏—à null",
    "vendor_ipn": "string: –Ü–ü–ù –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫–∞",
    "tax_system": "string: –°—Ç–∞—Ç—É—Å –ø–ª–∞—Ç–Ω–∏–∫–∞ –ø–æ–¥–∞—Ç–∫—ñ–≤ (–Ω–∞–ø—Ä. '–ó–∞–≥–∞–ª—å–Ω–∞ —Å–∏—Å—Ç–µ–º–∞')",
    "currency": "UAH: –í–∞–ª—é—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞",
    "amount_untaxed": 0.00, // –ó–∞–≥–∞–ª—å–Ω–∞ —Å—É–º–∞ –±–µ–∑ –ü–î–í
    "amount_tax": 0.00, // –°—É–º–∞ –ü–î–í (—Ä—ñ–∑–Ω–∏—Ü—è –º—ñ–∂ —ñ—Ç–æ–≥–æ–º –∑ –ü–î–í —Ç–∞ –±–µ–∑)
    "amount_total": 0.00, // –ü–æ–≤–Ω–∞ —Å—É–º–∞ –¥–æ —Å–ø–ª–∞—Ç–∏
    "due_date": "YYYY-MM-DD: –î–∞—Ç–∞ –æ–ø–ª–∞—Ç–∏ (—Ä–æ–∑—Ä–∞—Ö—É–π, —è–∫—â–æ –≤–∫–∞–∑–∞–Ω–æ —Ç–µ—Ä–º—ñ–Ω —É –¥–Ω—è—Ö, –∞–±–æ null)"
  },
  "lines": [
    {
      "line_number": 1, // –ü–æ—Ä—è–¥–∫–æ–≤–∏–π –Ω–æ–º–µ—Ä —Ä—è–¥–∫–∞
      "name": "string: –ù–∞–∑–≤–∞ —Ç–æ–≤–∞—Ä—É/–ø–æ—Å–ª—É–≥–∏ (–æ—á–∏—â–µ–Ω–∞ –≤—ñ–¥ –∑–∞–π–≤–∏—Ö –ø—Ä–æ–±—ñ–ª—ñ–≤,–∞—Ä—Ç–∏–∫—É–ª—ñ–≤ —Ç–∞ —à—Ç—Ä–∏—Ö–∫–æ–¥—ñ–≤)",
      "quantity": 0.000,
      "unit": "string: –û—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∞ –æ–¥. –≤–∏–º—ñ—Ä—É (–Ω–∞–ø—Ä. '100 —à—Ç', '—à—Ç', '–≥—Ä–Ω', '–º.–ø', '–ø–æ—Å–ª—É–≥–∞')",
      "price_unit": 0.00, // –¶—ñ–Ω–∞ –∑–∞ –æ–¥–∏–Ω–∏—Ü—é –ë–ï–ó –ü–î–í, —è–∫—â–æ –Ω–µ –¥–∞–Ω–æ - —Ä–æ–∑—Ä–∞—Ö—É–π —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ
      "tax_percent": 0, // –°—Ç–∞–≤–∫–∞: 0 –∞–±–æ 20 (–≤–∏–∑–Ω–∞—á –∑–∞ –º–∞—Ç–µ–º–∞—Ç–∏—á–Ω–æ—é —Ä—ñ–∑–Ω–∏—Ü–µ—é —Ü—ñ–Ω)
      "price_subtotal": 0.00, // –°—É–º–∞ —Ä—è–¥–∫–∞ –ë–ï–ó –ü–î–í, —è–∫—â–æ –Ω–µ –¥–∞–Ω–æ - —Ä–æ–∑—Ä–∞—Ö—É–π —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ
      "price_total": 0.00, // –°—É–º–∞ —Ä—è–¥–∫–∞ –ó –ü–î–í, —è–∫—â–æ –Ω–µ –¥–∞–Ω–æ - —Ä–æ–∑—Ä–∞—Ö—É–π —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ
      "article": "string: –ß–∏—Å—Ç–∏–π –∞—Ä—Ç–∏–∫—É–ª –≤–∏—Ä–æ–±–Ω–∏–∫–∞ –∞–±–æ null",
      "ukt_zed": "string: –¢—ñ–ª—å–∫–∏ —Ü–∏—Ñ—Ä–∏ –∫–æ–¥—É –£–ö–¢ –ó–ï–î –∞–±–æ null",
      "barcodes": ["string: –ú–∞—Å–∏–≤ —É—Å—ñ—Ö –∑–Ω–∞–π–¥–µ–Ω–∏—Ö —à—Ç—Ä–∏—Ö–∫–æ–¥—ñ–≤ –¥–ª—è —Ü—ñ—î—ó –ø–æ–∑–∏—Ü—ñ—ó –∞–±–æ []"]
    }
  ],
  "metadata": {
    "source": "string: –Ü–º'—è —Ñ–∞–π–ª—É",
    "origin_invoice": "string: –ù–æ–º–µ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞-–ø—ñ–¥—Å—Ç–∞–≤–∏ (—è–∫—â–æ –∑–Ω–∞–π–¥–µ–Ω–æ)"
  }
}
```

### 4. –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞
**–ú–æ–¥–µ–ª—å:** `dino.partner.nomenclature`

–ö–∞–∂–¥—ã–π –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç (–ø–æ—Å—Ç–∞–≤—â–∏–∫) –∏–º–µ–µ—Ç —Å–≤–æ–π —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã:
- `partner_id` - –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç
- `name` - —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ —É –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞
- `nomenclature_id` - —Å–≤—è–∑—å —Å–æ —Å–∫–ª–∞–¥—Å–∫–æ–π –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–æ–π (–Ω–∞—à–∞ –ø–æ–∑–∏—Ü–∏—è)
- `uom_id` - ID –µ–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è

**Constraint:** `(partner_id, name)` - —É–Ω–∏–∫–∞–ª—å–Ω–∞—è –ø–∞—Ä–∞

### 5. –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞
**–ú–æ–¥–µ–ª—å:** `dino.operation.document.specification`

–í –¥–æ–∫—É–º–µ–Ω—Ç –∑–∞–ø–∏—Å—ã–≤–∞–µ–º:
- –¢–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç–∞
- ID –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞ `partner_id`

–í —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞ —Ö—Ä–∞–Ω—è—Ç—Å—è:
- **supplier_nomenclature_id** - ID –∏–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞
- **nomenclature_id** - ID —Å–∫–ª–∞–¥—Å–∫–æ–π –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã
- **uom_id** - ID –µ–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è



## –ü—Ä–æ—Ü–µ—Å—Å –∏–º–ø–æ—Ä—Ç–∞

### –≠—Ç–∞–ø 1: –í–≤–æ–¥ –¥–æ–∫—É–º–µ–Ω—Ç–∞
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç
2. –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç –Ω–∞ –≤–∫–ª–∞–¥–∫—É "Import Text"
3. –í—ã–±–∏—Ä–∞–µ—Ç –∞–≥–µ–Ω—Ç–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ (–∏–ª–∏ –æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
4. –í—Å—Ç–∞–≤–ª—è–µ—Ç –≤ HTML –ø–æ–ª–µ:
   - –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞ (Ctrl+C ‚Üí Ctrl+V)
   - –°–∫—Ä–∏–Ω—à–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞ (Print Screen ‚Üí Ctrl+V)
   - –ö–æ–º–±–∏–Ω–∞—Ü–∏—é —Ç–µ–∫—Å—Ç–∞ –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

### –≠—Ç–∞–ø 2: –ü–∞—Ä—Å–∏–Ω–≥ –¥–∞–Ω–Ω—ã—Ö
**–§–∞–π–ª:** `documents/services/text_parser_service.py`

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –ü–æ–ª—É—á–∞–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–æ–ª—è `import_text_content`
2. –ò–∑–≤–ª–µ–∫–∞–µ–º —Ç–µ–∫—Å—Ç –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
3. –ü–æ–ª—É—á–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞ `text_parser_agent_id`
4. –§–æ—Ä–º–∏—Ä—É–µ–º–û–±—Ä–∞–±–æ—Ç–∫–∞ JSON –æ—Ç–≤–µ—Ç–∞
**–ú–µ—Ç–æ–¥:** `dino.operation.document.process_parsed_json()`

**–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:** JSON —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç –ø–∞—Ä—Å–µ—Ä–∞

#### 3.1. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞ (header):

**–¢–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç–∞ (`doc_type`):**
```python
# –ü–æ–∏—Å–∫ —Ç–∏–ø–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é
document_type = self.env['dino.document.type'].search([
    ('name', '=ilike', json_data['header']['doc_type'])
], limit=1)

# –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω - —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π
if not document_type:
    document_type = self.env['dino.document.type'].create({
        'name': json_data['header']['doc_type'],
        'code': json_data['header']['doc_type'].lower().replace(' ', '_'),
        'sequence': 50,
    })

document.document_type_id = document_type.id
```

**–û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:**
```python
# –ù–æ–º–µ—Ä –∏ –¥–∞—Ç–∞
document.number = json_data['header']['doc_number']
document.date = json_data['header']['doc_date']

# –í–∞–ª—é—Ç–∞
currency = self.env['res.currency'].search([
    ('name', '=', json_data['header']['currency'])
], limit=1)
if currency:
    document.currency_id = currency.id

# –°—É–º–º—ã
document.amount_tax = json_data['header']['amount_tax']
document.amount_total = json_data['header']['amount_total']
```

#### 3.2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–µ (vendor):

**–ü–æ–∏—Å–∫/—Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞ –ø–æ –Ñ–î–†–ü–û–£:**
```python
partner = self.env['dino.partner'].search([
    ('egrpou', '=', json_data['header']['vendor_edrpou'])
], limit=1)

if not partner:
    partner = self.env['dino.partner'].create({
        'name': json_data['header']['vendor_name'],
        'egrpou': json_data['header']['vendor_edrpou'],
    })
```

**–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞:**
```python
# –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
partner_vals = {
    'name': json_data['header']['vendor_name'],
    'egrpou': json_data['header']['vendor_edrpou'],
    'inn': json_data['header'].get('vendor_ipn'),  # INN = –Ü–ü–ù
    'address': json_data['header'].get('vendor_address'),
    'phone': json_data['header'].get('vendor_phone'),
}

partner.write(partner_vals)

# –ë–∞–Ω–∫–æ–≤—Å–∫–∏–π —Å—á–µ—Ç - —Å–æ–∑–¥–∞–µ–º/–Ω–∞—Ö–æ–¥–∏–º –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏
if json_data['header'].get('vendor_iban'):
    self.env['dino.partner.bank.account'].find_or_create(
        partner_id=partner.id,
        iban=json_data['header']['vendor_iban'],
        bank_name=json_data['header'].get('vendor_bank'),
        bank_city=json_data['header'].get('vendor_bank_city'),
        bank_mfo=json_data['header'].get('vendor_mfo')
    )

# –°–∏—Å—Ç–µ–º–∞ –Ω–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏—è
if json_data['header'].get('tax_system'):
    tax_system = self.env['dino.tax.system'].search([
        ('name', '=ilike', json_data['header']['tax_system'])
    ], limit=1)
    
    if not tax_system:
        tax_system = self.env['dino.tax.system'].create({
            'name': json_data['header']['tax_system'],
            'vat_rate': json_data['header'].get('amount_tax', 20.0),
        })
    
    partner.write({'tax_system_id': tax_system.id})

# –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞
partner.write(partner_vals)

# –ó–∞–ø–∏—Å–∞—Ç—å ID –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞ –≤ –¥–æ–∫—É–º–µ–Ω—Ç
document.partner_id = partner.id
```

**–§–∏–∫—Å–∞—Ü–∏—è —Å—É–º–º—ã –ù–î–°:**
- –í –¥–æ–∫—É–º–µ–Ω—Ç–µ: `document.amount_tax`
- –í –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–µ: —á–µ—Ä–µ–∑ `tax_system_id` (VAT rate –±–µ—Ä–µ—Ç—Å—è –∏–∑ —Å–∏—Å—Ç–µ–º—ã)
- –í —Å–∏—Å—Ç–µ–º–µ –Ω–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏—è: `tax_system.vat_rate`

#### 3.3. –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç—Ä–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞ (lines):
–î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ ‚Üí –≠—Ç–∞–ø 4 (—Ä–∞–±–æ—Ç–∞ —Å–æ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–º –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞)

### –≠—Ç–∞–ø 4:  –∑–∞–ø—Ä–æ—Å –∫ –∞–≥–µ–Ω—Ç—É:
   - **Python Parser**: —Ç–µ–∫—Å—Ç ‚Üí regex ‚Üí JSON
   - **AI Parser**: JSON template + prompt + —Ç–µ–∫—Å—Ç/–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ ‚Üí API ‚Üí JSON

**–î–ª—è AI –∞–≥–µ–Ω—Ç–æ–≤:**
```python
# –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞
headers = {
    "Authorization": f"Bearer {agent.api_key}",
    "Content-Type": "application/json"
}

request_data = {
    "model": agent.model_name,  # gpt-4o-mini, claude-3-5-haiku, etc.
    "temperature": agent.temperature,  # 0.0 –¥–ª—è —Ç–æ—á–Ω–æ—Å—Ç–∏
    "max_tokens": agent.max_tokens,  # 4000-8000
    "response_format": {"type": "json_object"},  # –°—Ç—Ä–æ–≥–∏–π JSON
    "messages": [
        {
            "role": "system",
            "content": agent.prompt_template  # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ + JSON schema
        },
        {
            "role": "user",
            "content": [
                {"type": "text", "text": document_text},
                {"type": "image_url", "image_url": document_image}  # –ï—Å–ª–∏ –µ—Å—Ç—å
            ]
        }
    ]
}

# –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞
response = requests.post(
    url=agent.api_endpoint or DEFAULT_ENDPOINT,
    headers=headers,
    json=request_data
)

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞
result = response.json()
parsed_json = json.loads(result['choices'][0]['message']['content'])

# –£—á–µ—Ç —Ç–æ–∫–µ–Ω–æ–≤
agent.increment_usage(
    tokens_used=result['usage']['total_tokens'],
    cost=calculate_cost(result['usage'], agent.model_name)
)

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
if result['finish_reason'] != 'stop':
    raise ValueError(f"AI response incomplete: {result['finish_reason']}")
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π JSON —Å–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞

### –≠—Ç–∞–ø 5: –†–∞–±–æ—Ç–∞ —Å–æ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–º –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞
**–ú–µ—Ç–æ–¥:** `dino.partner.nomenclature.find_or_create()`

```python
# –ü–æ–∏—Å–∫ –∏–ª–∏ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏
supplier_nomenclature = self.env['dino.partner.nomenclature'].find_or_create(
    partner_id=partner.id,
    supplier_name=name,
    auto_create=True
)
```6

**–õ–æ–≥–∏–∫–∞:**
- **–ù–∞—Ö–æ–¥–∏–º:** –ò—â–µ–º –∑–∞–ø–∏—Å—å –ø–æ `(partner_id, name)`
- **–ù–µ –Ω–∞—Ö–æ–¥–∏–º:** –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–µ
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–ª—É—á–∞–µ–º ID –∑–∞–ø–∏—Å–∏ –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–µ

### –≠—Ç–∞–ø 4: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–≤—è–∑–∏ —Å–æ —Å–∫–ª–∞–¥–æ–º
```python
# –ï—Å–ª–∏ —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ —Å–≤—è–∑—å - –±–µ—Ä–µ–º –µ—ë
nomenclature_id = supplier_nomenclature.nomenclature_id.id if supplier_nomenclature.nomenclature_id else False
```

**–õ–æ–≥–∏–∫–∞:**
- –ï—Å–ª–∏ –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–µ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞ —É–∂–µ –µ—Å—Ç—å —Å–≤—è–∑—å `nomenclature_id` ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –µ—ë
- –ï—Å–ª–∏ —Å–≤—è–∑–∏ –Ω–µ—Ç ‚Üí –æ—Å—Ç–∞–≤–ª—è–µ–º –ø—É—Å—Ç—ã–º (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—Å—Ç—Ä–æ–∏—Ç –≤—Ä—É—á–Ω—É—é)

### –≠—Ç–∞–ø 5: –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏
```python
vals = {
    'document_id': document.id,
    'name': name,  # –ù–∞–∑–≤–∞–Ω–∏–µ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞
    'quantity': qty,
    'price_untaxed': price_untaxed,
    'price_tax': price_with_tax,
    'supplier_nomenclature_id': supplier_nomenclature.id,  # ‚úì ID –∏–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞
    'nomenclature_id': nomenclature_id,  # ‚úì ID —Å–∫–ª–∞–¥–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å)
}
```

## –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

### –í —Ñ–æ—Ä–º–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
```
Supplier Item Mapping    | Stock Item
-------------------------|---------------------------
–ë–æ–ª—Ç –ú8 (ID: 123) ‚Üí      | –ë–æ–ª—Ç –º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–π –ú8—Ö20 (ID: 456)
–ì–∞–π–∫–∞ –ú10 (ID: 124) ‚Üí    | [–ø—É—Å—Ç–æ - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—Å—Ç—Ä–æ–∏—Ç]
```

### Onchange —Å–æ–±—ã—Ç–∏—è

#### –ü—Ä–∏ –≤—ã–±–æ—Ä–µ `supplier_nomenclature_id`:
```python
@api.onchange('supplier_nomenclature_id')
def _onchange_supplier_nomenclature_id(self):
    # –ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ:
    self.name = supplier_nomenclature_id.name
    self.nomenclature_id = supplier_nomenclature_id.nomenclature_id
    self.uom_id = supplier_nomenclature_id.uom_id
```

#### –ü—Ä–∏ –≤—ã–±–æ—Ä–µ `nomenclature_id`:
```python
@api.onchange('nomenclature_id')
def _onchange_nomenclature_id(self):
    # –ï—Å–ª–∏ —Å–≤—è–∑–∏ –µ—â–µ –Ω–µ—Ç - —Å–æ–∑–¥–∞–µ–º –µ—ë –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–µ
    if not supplier_nomenclature_id.nomenclature_id:
        supplier_nomenclature_id.nomenclature_id = nomenclature_id
```

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø–æ–¥—Ö–æ–¥–∞

### ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫
- –û–¥–∏–Ω –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç ‚Üí –æ–¥–∏–Ω —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –µ–≥–æ –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã
- –ò—Å–∫–ª—é—á–µ–Ω—ã –¥—É–±–ª–∏–∫–∞—Ç—ã –Ω–∞–∑–≤–∞–Ω–∏–π –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞
- –ò—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö –ø–æ–∑–∏—Ü–∏–π –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ

### ‚úÖ –ì–∏–±–∫–∏–µ —Å–≤—è–∑–∏
- –°–≤—è–∑—å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑
- –ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –∏–º–ø–æ—Ä—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è
- –ú–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å —Å–≤—è–∑—å –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç

### ‚úÖ –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ —Å–≤—è–∑—ã–≤–∞–Ω–∏–µ
- –ù–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–≤—è–∑—ã–≤–∞—Ç—å –≤—Å–µ —Å—Ä–∞–∑—É
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —á—Ç–æ –Ω–µ —Å–≤—è–∑–∞–Ω–æ
- –°–≤—è–∑—ã–≤–∞–Ω–∏–µ –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

### ‚úÖ –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å
- –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã—Ö –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–æ–≤
- –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Ç–∏–ø—ã —Ñ–∞–π–ª–æ–≤
- –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–∞—Ä—Å–µ—Ä–æ–≤

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### 1. –ü–µ—Ä–≤—ã–π –∏–º–ø–æ—Ä—Ç –æ—Ç –Ω–æ–≤–æ–≥–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞
```
–§–∞–π–ª Excel ‚Üí –ü–∞—Ä—Å–µ—Ä ‚Üí 20 –ø–æ–∑–∏—Ü–∏–π
‚Üì
–°–æ–∑–¥–∞–Ω–æ –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–µ: 20 –Ω–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π
–°–≤—è–∑–µ–π —Å–æ —Å–∫–ª–∞–¥–æ–º: 0
‚Üì
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Å–≤—è–∑–∏ –≤—Ä—É—á–Ω—É—é
```

### 2. –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∏–º–ø–æ—Ä—Ç –æ—Ç —Ç–æ–≥–æ –∂–µ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞
```
–§–∞–π–ª Excel ‚Üí –ü–∞—Ä—Å–µ—Ä ‚Üí 20 –ø–æ–∑–∏—Ü–∏–π (15 —Å—Ç–∞—Ä—ã—Ö + 5 –Ω–æ–≤—ã—Ö)
‚Üì
–ù–∞–π–¥–µ–Ω–æ –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–µ: 15 –∑–∞–ø–∏—Å–µ–π (—Å–≤—è–∑–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã)
–°–æ–∑–¥–∞–Ω–æ –Ω–æ–≤—ã—Ö: 5 –∑–∞–ø–∏—Å–µ–π
‚Üì
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ 5 –Ω–æ–≤—ã—Ö –ø–æ–∑–∏—Ü–∏–π
```

### 3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Å–≤—è–∑–µ–π
```
–ò–º–ø–æ—Ä—Ç ‚Üí supplier_nomenclature –Ω–∞–π–¥–µ–Ω
‚Üì
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç nomenclature_id
‚Üì
Onchange –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–≤—è–∑—å –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–µ
‚Üì
–°–ª–µ–¥—É—é—â–∏–π –∏–º–ø–æ—Ä—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω–∏—Ç —ç—Ç—É —Å–≤—è–∑—å
```

## –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∞–≥–µ–Ω—Ç—ã –ø–∞—Ä—Å–∏–Ω–≥–∞

### ‚úÖ Python Regex Parser
- –õ–æ–∫–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
- –ë—ã—Å—Ç—Ä–æ –∏ –±–µ—Å–ø–ª–∞—Ç–Ω–æ
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —É–∫—Ä–∞–∏–Ω—Å–∫–∏—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ: –Ω–æ–º–µ—Ä, –¥–∞—Ç–∞, –Ñ–î–†–ü–û–£, —Ç–∞–±–ª–∏—Ü–∞ –ø–æ–∑–∏—Ü–∏–π

### ‚úÖ OpenAI-Compatible API (Universal)
**–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø–∞—Ä—Å–µ—Ä –¥–ª—è –≤—Å–µ—Ö OpenAI-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã—Ö API:**
- OpenAI (GPT-4o, GPT-4o-mini)
- Azure OpenAI
- OpenRouter (Qwen, Claude, Gemini —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏)
- –î—Ä—É–≥–∏–µ OpenAI-compatible —Å–µ—Ä–≤–∏—Å—ã

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É –∞–≥–µ–Ω—Ç–∞ (–±–µ–∑ –∫–æ–¥–∞)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ JSON —Å—Ö–µ–º—ã –∏–∑ —Ñ–∞–π–ª–∞
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (—Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ)
- –ü–æ–¥—Å—á–µ—Ç —Ç–æ–∫–µ–Ω–æ–≤ –∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏
- ~$0.001 –∑–∞ –¥–æ–∫—É–º–µ–Ω—Ç (GPT-4o-mini)

### üîú Anthropic Claude
- –ü—Ä—è–º–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Anthropic API
- –í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —É–∫—Ä–∞–∏–Ω—Å–∫–æ–≥–æ —è–∑—ã–∫–∞

### üîú Google Gemini
- –ü—Ä—è–º–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Google AI
- –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π tier (–ª–∏–º–∏—Ç—ã)
- –•–æ—Ä–æ—à–∞—è —Ä–∞–±–æ—Ç–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
```python
# –ò–º–ø–æ—Ä—Ç —Ç–µ–∫—Å—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞
document = env['dino.operation.document'].browse(document_id)
document.write({
    'import_text_content': document_text,
    'text_parser_agent_id': agent.id,
})
document.action_import_text()
```

### –°–æ–∑–¥–∞–Ω–∏–µ –∞–≥–µ–Ω—Ç–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞
```python
# –°–æ–∑–¥–∞—Ç—å —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π AI –∞–≥–µ–Ω—Ç–∞ –¥–ª—è OpenAI
agent = env['dino.parser.agent'].create({
    'name': 'GPT-4o-mini Universal Parser',
    'agent_type': 'ai_openai_compatible',
    'api_key': 'sk-...',
    'api_endpoint': 'https://api.openai.com/v1/chat/completions',
    'model_name': 'gpt-4o-mini',
    'temperature': 0.0,
    'max_tokens': 4000,
    'description': '–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø–∞—Ä—Å–µ—Ä –¥–ª—è OpenAI API',
})

# JSON —Å—Ö–µ–º–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ —Ñ–∞–π–ª–∞:
# documents/services/json_schema_template.json

# –°–æ–∑–¥–∞—Ç—å –∞–≥–µ–Ω—Ç–∞ –¥–ª—è OpenRouter (Qwen)
agent_qwen = env['dino.parser.agent'].create({
    'name': 'Qwen 2.5 VL 72B via OpenRouter',
    'agent_type': 'ai_openai_compatible',  # –¢–æ—Ç –∂–µ —Ç–∏–ø!
    'api_key': 'sk-or-v1-...',
    'api_endpoint': 'https://openrouter.ai/api/v1/chat/completions',
    'model_name': 'qwen/qwen-2.5-vl-72b-instruct',
    'temperature': 0.0,
    'max_tokens': 8000,
    'rate_limit_rpm': 20,  # –î–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
    'rate_limit_tpm': 100000,
})

# –°–æ–∑–¥–∞—Ç—å –∞–≥–µ–Ω—Ç–∞ –¥–ª—è Azure OpenAI
agent_azure = env['dino.parser.agent'].create({
    'name': 'Azure GPT-4o',
    'agent_type': 'ai_openai_compatible',  # –¢–æ—Ç –∂–µ —Ç–∏–ø!
    'api_key': '<your-azure-api-key>',
    'api_endpoint': 'https://<your-resource>.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-02-15-preview',
    'model_name': 'gpt-4o',
    'temperature': 0.0,
})
```

### –†–∞–±–æ—Ç–∞ —Å–æ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–º
```python
# –ù–∞–π—Ç–∏ –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å
mapping = env['dino.partner.nomenclature'].find_or_create(
    partner_id=partner.id,
    supplier_name='–ë–æ–ª—Ç –ú8',
    auto_create=True
)

# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–≤—è–∑—å
mapping.nomenclature_id = warehouse_item.id
```

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –≥–∏–±—Ä–∏–¥–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞

### ‚úÖ –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å –≤–≤–æ–¥–∞
- –†–∞–±–æ—Ç–∞ —Å –ª—é–±—ã–º–∏ —Ñ–æ—Ä–º–∞—Ç–∞–º–∏ (—Ç–µ–∫—Å—Ç, —Å–∫—Ä–∏–Ω—à–æ—Ç, PDF-–∫–æ–ø–∏—è)
- –ù–µ –Ω—É–∂–Ω—ã —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç—ã –∏–∑ –¥—Ä—É–≥–∏—Ö —Å–∏—Å—Ç–µ–º
- –ü—Ä–æ—Å—Ç–æ Ctrl+C ‚Üí Ctrl+V

### ‚úÖ –ì–∏–±–∫–∏–π –≤—ã–±–æ—Ä –ø–∞—Ä—Å–µ—Ä–∞
- –ü—Ä–æ—Å—Ç—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã ‚Üí –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π regex –ø–∞—Ä—Å–µ—Ä
- –°–ª–æ–∂–Ω—ã–µ/—Å–∫–∞–Ω—ã ‚Üí AI —Å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤

### ‚úÖ –ï–¥–∏–Ω—ã–π JSON —Ñ–æ—Ä–º–∞—Ç
- –ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- –õ–µ–≥–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø–∞—Ä—Å–µ—Ä–æ–≤
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

### ‚úÖ –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –∞–≥–µ–Ω—Ç—ã
- JSON —à–∞–±–ª–æ–Ω –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –Ω—É–∂–¥—ã
- –ü—Ä–æ–º–ø—Ç—ã –º–æ–∂–Ω–æ –¥–æ—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞
- A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–Ω—ã—Ö AI –º–æ–¥–µ–ª–µ–πpython
# –ù–∞–π—Ç–∏ –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å
mapping = env['dino.partner.nomenclature'].find_or_create(
    partner_id=partner.id,
    supplier_name='–ë–æ–ª—Ç –ú8',
    auto_create=True
)

# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–≤—è–∑—å
mapping.nomenclature_id = warehouse_item.id
```

# –¢–µ—Å—Ç —Ä–æ–±–æ—Ç–∏ units_list

## –Ø–∫ –ø—Ä–∞—Ü—é—î:

```python
# 1. –í dino_parser_agent.py (–ø—Ä–∏ –≤–∏–∫–ª–∏–∫—É –ø–∞—Ä—Å–µ—Ä–∞)
units_list = self.env['dino.uom'].search([('active', '=', True)]).mapped('name')
# –†–µ–∑—É–ª—å—Ç–∞—Ç: ['—à—Ç', '–∫–≥', '–ª', '–º', '–º¬≤', '–∫–æ–º–ø–ª', ...]

# 2. –ü–µ—Ä–µ–¥–∞—î—Ç—å—Å—è –≤ AIParserService.parse()
result = AIParserService.parse(
    text=document_text,
    units_list=units_list,  # ‚Üê –°–ø–∏—Å–æ–∫ –∑ –ë–î
    **other_params
)

# 3. –í ai_parser_service.py
units_str = f"\n\nüì¶ –î–æ—Å—Ç—É–ø–Ω—ñ –æ–¥–∏–Ω–∏—Ü—ñ –≤–∏–º—ñ—Ä—É: —à—Ç, –∫–≥, –ª, –º, –º¬≤, –∫–æ–º–ø–ª, ..."
system_prompt = f"{parsing_template}{units_str}\n\n–ü–æ–≤–µ—Ä–Ω–∏ –¢–Ü–õ–¨–ö–ò –≤–∞–ª—ñ–¥–Ω–∏–π JSON..."

# 4. AI –±–∞—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –ø—Ä–∞–≤–∏–ª—å–Ω—ñ –æ–¥–∏–Ω–∏—Ü—ñ
```

## –ü—Ä–∏–∫–ª–∞–¥ –ø—Ä–æ–º–ø—Ç—É —è–∫–∏–π –æ—Ç—Ä–∏–º–∞—î AI:

```
# AI Parsing Template (Compact Version)

## Instructions
...

üì¶ –î–æ—Å—Ç—É–ø–Ω—ñ –æ–¥–∏–Ω–∏—Ü—ñ –≤–∏–º—ñ—Ä—É: —à—Ç, –∫–≥, –ª, –º, –º¬≤, –º¬≥, –∫–æ–º–ø–ª, —É–ø, –ø–æ–≥.–º, —Ç, –≥, –º–ª, —Å–º, –º–º

–ü–æ–≤–µ—Ä–Ω–∏ –¢–Ü–õ–¨–ö–ò –≤–∞–ª—ñ–¥–Ω–∏–π JSON. –ú–æ–≤–∞: —É–∫—Ä–∞—ó–Ω—Å—å–∫–∞.
```

## –ü–µ—Ä–µ–≤–∞–≥–∏:

1. ‚úÖ **–ê–∫—Ç—É–∞–ª—å–Ω–∏–π —Å–ø–∏—Å–æ–∫** - –∑ –ë–î, –∞ –Ω–µ –∂–æ—Ä—Å—Ç–∫–æ –∑–∞–∫–æ–¥–æ–≤–∞–Ω–∏–π
2. ‚úÖ **–û–±–º–µ–∂–µ–Ω–æ –¥–æ 50** - –µ–∫–æ–Ω–æ–º—ñ—è —Ç–æ–∫–µ–Ω—ñ–≤ (—è–∫—â–æ –æ–¥–∏–Ω–∏—Ü—å > 50)
3. ‚úÖ **Fallback** - —è–∫—â–æ –ë–î –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞, –ø—Ä–∞—Ü—é—î –±–µ–∑ —Å–ø–∏—Å–∫—É
4. ‚úÖ **–õ–æ–≥—É–≤–∞–Ω–Ω—è** - –≤–∏–¥–Ω–æ —Å–∫—ñ–ª—å–∫–∏ –æ–¥–∏–Ω–∏—Ü—å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ

## –Ø–∫ –¥–æ–¥–∞—Ç–∏ –Ω–æ–≤—ñ –æ–¥–∏–Ω–∏—Ü—ñ:

```python
# –í Odoo UI –∞–±–æ —á–µ—Ä–µ–∑ –∫–æ–¥
self.env['dino.uom'].create({
    'name': '–ø–æ–≥.–º',
    'rounding': 0.01,
    'active': True
})

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø–æ—Ç—Ä–∞–ø–∏—Ç—å –≤ –ø—Ä–æ–º–ø—Ç –ø—Ä–∏ –Ω–∞—Å—Ç—É–ø–Ω–æ–º—É –ø–∞—Ä—Å–∏–Ω–≥—É!
```

## –©–æ –¥–∞–ª—ñ?

–ù–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫: –æ–Ω–æ–≤–∏—Ç–∏ `_validate_and_fix_math()` –∑ –Ω–æ–≤–æ—é –ª–æ–≥—ñ–∫–æ—é:
- –°—Ç–∞–≤–∫–∞ –ü–î–í –∑ –ø—ñ–¥—Å—É–º–∫—ñ–≤
- –ó–∞–ø–æ–≤–Ω–µ–Ω–Ω—è –≤—ñ–¥—Å—É—Ç–Ω—ñ—Ö –ø–æ–ª—ñ–≤
- –û–∫—Ä—É–≥–ª–µ–Ω–Ω—è 0.001 ‚Üí 0.01
- –†–æ–∑–ø–æ–¥—ñ–ª —Ä—ñ–∑–Ω–∏—Ü—ñ

**–ü—Ä–æ–¥–æ–≤–∂—É—î–º–æ?** üöÄ


–ü–û–õ–Ø –°–ü–ï–¶–ú–§–ò–ö–ê–¶–ú–ú

–≤ —Å–ø—Ä–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –Ω—É–∂–Ω–æ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –ø–æ–ª—è:

- line_number - ‚Ññ —Å—Ç—Ä–æ–∫–∏ (Integer, –≤—ã—á–∏—Å–ª—è–µ–º–æ–µ)
- supplier_nomenclature_id - –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞  (Many2one ‚Üí dino.partner.nomenclature)
- nomenclature_id - –í–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ (Many2one ‚Üí dino.nomenclature) üö´
- quantity - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ (Float, required, default=1.0)
- dino_uom_id - –ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è (Many2one ‚Üí dino.uom)
- price_untaxed - –¶–µ–Ω–∞ –ë–ï–ó –ù–î–° (Monetary, required)
- price_tax - –¶–µ–Ω–∞ –° –ù–î–° (Monetary) üö´
- amount_untaxed - –°—É–º–º–∞ –ë–ï–ó –ù–î–° (Monetary, computed: qty √ó price) üö´
- amount_tax - –°—É–º–º–∞ –ù–î–° (Monetary, computed)
- vat_rate - –°—Ç–∞–≤–∫–∞ –ù–î–° % (Float, related from document) üö´
- article - –ê—Ä—Ç–∏–∫—É–ª (Char) üö´
- ukt_zed - –£–ö–¢ –ó–ï–î (Char) üö´
- description - –ü—Ä–∏–º–µ—á–∞–Ω–∏—è (Text) üö´

–≥–¥–µ üö´ - –ø–æ–ª—è –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ —Å–∫—Ä—ã—Ç—å/–ø–æ–∫–∞–∑–∞—Ç—å

–†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º—ã–µ –ø–æ–ª—è:
- price_untaxed - –¶–µ–Ω–∞ –ë–ï–ó –ù–î–° (Monetary, required)
- price_tax - –¶–µ–Ω–∞ –° –ù–î–° (Monetary)
- vat_rate - –°—Ç–∞–≤–∫–∞ –ù–î–° % 

–ò –∑–≤–∑–∞–∏–º–Ω—ã–π –ø–µ—Ä–µ—Å—á–µ—Ç –ø–æ –∏–∑–º–µ–Ω–µ–Ω–∏—é –ª—é–±–æ–≥–æ –∏–∑ –Ω–∏—Ö